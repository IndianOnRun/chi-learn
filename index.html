<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3: Setting path fills dynamically to generate a choropleth</title>
		<script type="text/javascript" src="viewer/d3/d3.v3.js"></script>

			<style type="text/css">

			path:hover {
				fill: orange;
			}
		</style>
	</head>
	<body>
        <!-- Bring in the numToArea object that maps from community area numbers to names -->
        <script src="viewer/js/number_to_community_area.js"></script>
        <script src="viewer/js/baseline.js"></script>
		<script type="text/javascript">

			//Width and height
			var w = 500;
			var h = 650;

			//Create SVG element
			var svg = d3.select("body")
						.append("svg")
						.attr("width", w)
						.attr("height", h);

            //Define quantize scale to sort data values into buckets of color
			var color = d3.scale.quantize()
								.range(["rgb(237,248,233)",
                                        "rgb(186,228,179)",
                                        "rgb(116,196,118)",
                                        "rgb(49,163,84)",
                                        "rgb(0,109,44)"])
                                .domain([0,1]);


            //Load in GeoJSON data
            d3.json("viewer/json/commAreasGeo.json", function(geoJson) {

                for (var index in geoJson.features) {
                    area = geoJson.features[index];
                    geoJson.features[index].name = numToAreaName[area.area_number];
                    geoJson.features[index].crimeRate = areaNumToCrimeRate[area.area_number]
                }


                // new projection
                var projection = d3.geo.mercator().scale([243300])
                        .center([-87.68398142305401, 41.92394041])
                        .translate([250.02673254274777, 174.99268431711602]);

                var path = d3.geo.path().projection(projection);


                svg.selectAll("path")
                        .data(geoJson.features)
                        .enter()
                        .append("path")
                        .attr("d", path)
                        .style("fill", function(d){
                            return color(d.crimeRate)
                        })
                        .style("stroke-width", "1")
                                .style("stroke", "black")
                                .append("title")
                                .text(function(d){
                                    return d.name
                                })

            });

		</script>
	</body>
</html>